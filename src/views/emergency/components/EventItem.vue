<template>
    <div class="item" flex @click="clickDataItem">
        <div class="item-left">
            <pin :content="index" :isActive="isActive"></pin>
        </div>
        <div class="item-right" flex="dir:top">
            <div class="top" flex="cross: center main:justify">
                <div class="name-panel" :title="itemData.name">{{ itemData.name }}</div>
                <div class="flag-panel">
                    <span class="level-panel "
                        :class="{yanzhong:itemData.levelId == '02',yiban:itemData.levelId == '01'}">等级：{{itemData.levelName}}</span>
                    <span v-if="itemData.statusId == '1'" class="status-panel nostart">未开始</span>
                    <span v-if="itemData.statusId == '2'" class="status-panel handle">进行中</span>
                    <span v-if="itemData.statusId == '3'" class="status-panel complete">已完成</span>
                </div>
            </div>
            <div class="item_body">
                <div class="description-panel" flex><span>信息：</span><span>{{ itemData.description }}</span></div>
                <div class="description-panel" flex><span>位置：</span><span>{{ itemData.position }}</span></div>
                <div class="description-panel" flex><span>时间：</span><span v-if="itemData.startDay">{{ new Date(parseInt(itemData.startDay))|date_format('YYYY-MM-DD HH:mm') }}</span></div>
            </div>
            <div class="item-operate">
                <span v-if="itemData.statusId == '1'" class="operate-btn" @click.stop="editYuan(itemData)">
                    <cg-icon-svg name="edit" class="svg_icon_edit"></cg-icon-svg>编辑
                </span>
                <span v-if="itemData.statusId != '2'" class="operate-btn" @click.stop="deleteYuan(itemData)">
                    <cg-icon-svg name="delete" class="svg_icon_delete"></cg-icon-svg>删除
                </span>
            </div>
            <div class="to-next" v-if="itemData.stageName">
                <a-tooltip placement="top" >
                    <template slot="title">
                        <span>{{textShow[itemData.stageName]}}</span>
                    </template>
                    <span class="stage_btn"
                          :class="{blue:itemData.stageName=='消息阶段',orange:itemData.stageName=='警报阶段',red:itemData.stageName=='紧急警报阶段',green:itemData.stageName=='警报解除阶段'}"
                          @click="goToNextStage(itemData)"
                    >{{itemData.stageName}}<a-icon type="caret-right" /></span>
                </a-tooltip>
            </div>
        </div>
    </div>
</template>
<script type="text/ecmascript-6">
    import Pin from './Position.vue';
    import dayjs from 'dayjs'
    export default {
        name: 'yuAnItem',
        props:{
            //序号
            index:{
                type:Number,
                default: null
            },
            //展示数据
            itemData:{
                type: Object,
                default(){
                    return {

                    }
                }
            },
            //是否激活
            isActive:{
                type: Boolean,
                default: false
            }
        },
        data(){
            return{
                textShow:{
                  '消息阶段':'现阶段为消息阶段，请点击进入事件触发下一个阶段',
                  '警报阶段':'现阶段为警报阶段，请点击进入事件触发下一个阶段',
                  '紧急警报阶段':'现阶段为紧急警报阶段，请点击进入事件触发下一个阶段',
                  '警报解除阶段':'现阶段为警报解除阶段，该事件已结束'
                }
            }
        },
        components:{
            Pin
        },
        methods:{
            editYuan(item){
                this.$emit('editYuAnItem',item);
            },
            deleteYuan(item){
                this.$emit('deleteYuAnItem',item);
            },
            clickDataItem(){
                this.$emit('onClick');
            },
            goToNextStage(item){
              this.$emit('goToNextStage',item);
            }
        }
    }
</script>
<style lang="scss" scoped>
    .item {
        padding: 20px 20px 0px 20px;
        &:hover,&.active{
            background-color: #e9f6ff;
        }
        .item-left {
            width: 25px;
            height: 25px;
            .icon_pin {
                display: inline-block;
                width: 25px;
                height: 25px;
                line-height: 20px;
                text-align: center;
                font-family: PingFang-SC-Heavy;
                font-size: 16px;
                color: #ffffff;
            }
        }
        .item-right {
            width: 100%;
            padding-left: 5px;
            padding-bottom: 10px;
            border-bottom: solid 1px #dddddd;
            position: relative;
            .top {
                height: 18px;
                width: 100%;
                .name-panel {
                    font-family: PingFang-SC-Heavy;
                    font-size: 14px;
                    color: #333333;
                    max-width: 155px;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                }
                .flag-panel {
                    .level-panel {
                        border-radius: 7px;
                        font-family: PingFang-SC-Medium;
                        font-size: 12px;
                        color: #ffffff;
                        padding: 1px 6px;
                        &.yanzhong {
                            background-color: #f07171;
                        }
                        &.yiban {
                            background-color: #f99f12;
                        }
                    }
                    .status-panel {
                        border-radius: 7px;
                        font-family: PingFang-SC-Medium;
                        font-size: 12px;
                        color: #ffffff;
                        padding: 1px 6px;
                        margin-left: 10px;
                        &.handle {
                            background-color: #2b8ff3;
                        }
                        &.nostart {
                            background-color: #999999;
                        }
                        &.complete {
                            background-color: #50cf3f;
                        }
                    }
                }
            }
            .item_body{
                margin: 8px 0px;
                max-height: 200px;
                .description-panel {
                    font-family: PingFang-SC-Medium;
                    font-size: 13px;
                    line-height: 18px;
                    color: #666666;
                    overflow: hidden;
                    span:first-child{
                        width: 50px;
                    }
                    span:last-child{
                        width: 100%;
                        display: -webkit-box;
                        -webkit-box-orient: vertical;
                        -webkit-line-clamp: 3;
                    }
                }
            }

            .item-operate {
                .operate-btn {
                    display: inline-block;
                    width: 60px;
                    height: 18px;
                    line-height: 18px;
                    font-family: PingFang-SC-Medium;
                    font-size: 13px;
                    color: #2c90f3;
                    cursor: pointer;
                    .svg_icon_edit,.svg_icon_delete{
                        width: 12px;
                        height: 14px;
                        color: #2c90f3;
                        margin-right: 5px;
                    }
                }
            }
            .to-next{
                position:absolute;
                right:0px;
                bottom:20px;
                .stage_btn{
                    display:inline-block;
                    height: 28px;
                    line-height: 28px;
                    border-radius: 4px;
                    padding: 0px 8px 0px 12px;
                    font-family: PingFang-SC-Medium;
                    font-size: 13px;
                    color: #ffffff;
                    cursor: pointer;
                    &.blue{
                        background-color: #2b90f3;
                    }
                    &.orange{
                        background-color: #f99927;
                    }
                    &.red{
                        background-color: #f96363;
                    }
                    &.green{
                        background-color: #49c61a;
                    }
                }
            }
        }
    }
</style>
